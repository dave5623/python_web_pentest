import requests
from bs4 import BeautifulSoup, SoupStrainer

url = "http://192.168.152.176/guestbook.php"
url2 = "http://192.168.152.176/addguestbook.php"
url3 = "http://192.168.152.176/viewguestbook.php"

f = open("../lib/interesting-metacharacters.txt", 'r')
o = open("results.txt", 'a')

print "Fuzzing begins!"

initial = requests.get(url)
for payload in f.readlines():
    for field in BeautifulSoup(initial.text, 'html.parser', parse_only=SoupStrainer('input')):
        d = {}
        if field.has_attr('name'):
            if field['name'].lower() == "submit":
                d[field['name']] = "submit"
            else:
                d[field['name']] = payload

    req = requests.post(url2, data=d)
    response = requests.get(url3)

    o.write("Payload: " + payload + "\r\n")
    o.write(response.text + "\r\n")

print "Fuzzing has ended"

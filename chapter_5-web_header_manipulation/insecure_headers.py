import requests

urls = open("urls.txt", "r")
for url in urls:
    url = url.strip()
    req = requests.get(url)
    print url, 'report:'

    # X-XSS-Protection header should be set to 1; mode=block to enable XSS protection in the browser
    try:
        xssprotect = req.headers['X-XSS-Protection']
        if xssprotect != '1; mode=block':
            print "X-XSS-Protection is not set properly, XSS may be possible: ", xssprotect
    except:
        print "X-XSS-Protection is not set, XSS may be possible"

    # X-Content-Type-Options header should be set to nosniff to prevent MIME type confusion
    try:
        contenttype = req.headers['X-Content-Type-Options']
        if contenttype != 'nosniff':
            print "X-Content-Type-Options not set properly: ", contenttype
    except:
        print "X-Content-Type-Options not set"

    # Strict-Transport-Security header is used to force communication over a HTTPS channel, to prevent man in the middle (MITM) attacks
    try:
        hsts = req.headers['Strict-Transport-Security']
    except:
        print 'HSTS not set, MITM attacks may be possible'

    # Content-Security-Policy header is used to restrict the type of resources that can load on the web page
    try:
        csp = req.headers['Content-Security-Policy']
        print "Content-Security-Policy set: ", csp
    except:
        print "Content-Security-Policy missing"

    print "------"
